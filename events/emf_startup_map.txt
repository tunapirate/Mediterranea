# -*- ck2.events -*-

namespace = emf_startup
# event IDs emf_startup.30-emf_startup.39 are free to use in this file

# emf_startup.31 [Isis]
#
# Persian/Levant/African troop balance modifiers (counteract overrepresentation of Europe in terms of levy output in SWMH)
character_event = {
	id = emf_startup.31
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		has_landed_title = e_hip
	}
	
	immediate = {
		any_province = {
			limit = {
				region = emf_region_levy_boost
				has_owner = yes
			}
			add_province_modifier = {
				name = emf_levy_boost_local
				hidden = yes
				duration = -1
			}
		}
	}
}

# emf_startup.32 [Isis]
#
# Setup William Iron-Arm and descendent(s) in years [1043,1066)
character_event = {
	id = emf_startup.32
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		has_landed_title = e_hip
		year = 1043
		NOT = { year = 1066 }
		NOT = { has_game_rule = { name = railroading value = passive } }
	}
	
	immediate = {
		random_independent_ruler = {
			limit = {
				dynasty = 678 # de Hauteville
				capital_scope = { region = emf_region_norman_sicily }
			}
			save_event_target_as = emf_ironarm
			capital_scope = { save_event_target_as = emf_ironarm_capital }
		}
	}
	
	option = {
		name = OK
		event_target:emf_ironarm = {
			if = {
				limit = { ai = no }
				spawn_unit = {
					province = event_target:emf_ironarm_capital
					owner = event_target:emf_ironarm
					earmark = start_troops
					troops = {
						heavy_infantry = { 188 188 }
						knights = { 188 188 }
						light_cavalry = { 375 375 }
					}
					attrition = 1.0
				}
				spawn_unit = {
					province = event_target:emf_ironarm_capital
					owner = event_target:emf_ironarm
					earmark = start_troops
					troops = {
						heavy_infantry = { 188 188 }
						knights = { 188 188 }
						light_cavalry = { 375 375 }
					}
					attrition = 1.0
				}
				spawn_unit = {
					province = event_target:emf_ironarm_capital
					owner = event_target:emf_ironarm
					earmark = start_troops
					troops = {
						heavy_infantry = { 188 188 }
						knights = { 188 188 }
						light_cavalry = { 375 375 }
					}
					attrition = 1.0
					merge = yes
				}
			}
			if = {
				limit = { ai = yes }
				if = {
					limit = { has_game_rule = { name = railroading value = aggressive } }
					# in addition to the 3 flanks spawned below this, for aggressive...
					spawn_unit = {
						province = event_target:emf_ironarm_capital
						owner = event_target:emf_ironarm
						earmark = start_troops
						troops = {
							heavy_infantry = { 375 375 }
							knights = { 300 300 }
							light_cavalry = { 525 525 }
						}
						reinforces = yes
						reinforce_rate_multiplier = 0.25
						attrition = 0.1
					}
					spawn_unit = {
						province = event_target:emf_ironarm_capital
						owner = event_target:emf_ironarm
						earmark = start_troops
						troops = {
							heavy_infantry = { 375 375 }
							knights = { 300 300 }
							light_cavalry = { 525 525 }
						}
						reinforces = yes
						reinforce_rate_multiplier = 0.25
						attrition = 0.1
					}
					spawn_unit = {
						province = event_target:emf_ironarm_capital
						owner = event_target:emf_ironarm
						earmark = start_troops
						troops = {
							heavy_infantry = { 375 375 }
							knights = { 300 300 }
							light_cavalry = { 525 525 }
						}
						reinforces = yes
						reinforce_rate_multiplier = 0.25
						attrition = 0.1
					}
				}
				spawn_unit = {
					province = event_target:emf_ironarm_capital
					owner = event_target:emf_ironarm
					earmark = start_troops
					troops = {
						heavy_infantry = { 375 375 }
						knights = { 300 300 }
						light_cavalry = { 525 525 }
					}
					reinforces = yes
					attrition = 0.1
				}
				spawn_unit = {
					province = event_target:emf_ironarm_capital
					owner = event_target:emf_ironarm
					earmark = start_troops
					troops = {
						heavy_infantry = { 375 375 }
						knights = { 300 300 }
						light_cavalry = { 525 525 }
					}
					reinforces = yes
					attrition = 0.1
				}
				spawn_unit = {
					province = event_target:emf_ironarm_capital
					owner = event_target:emf_ironarm
					earmark = start_troops
					troops = {
						heavy_infantry = { 375 375 }
						knights = { 300 300 }
						light_cavalry = { 525 525 }
					}
					reinforces = yes
					attrition = 0.1
					merge = yes
				}
			}
		}
	}
}
